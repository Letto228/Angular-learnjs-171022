<!-- <mat-form-field appearance="fill" class="example-full-width"> -->
<!-- <mat-label>Search</mat-label> -->
<!-- <input [formControl]="searchControl"/> -->
<!-- </mat-form-field> -->
<!-- <h1>formControl: {{(searchControlErrors$ | async) | json}}</h1> -->
<!-- <h1>formControl: {{searchControl.errors | json}}</h1> -->

<!-- <mat-form-field appearance="fill" class="example-full-width"> -->
<!-- <mat-label>Search</mat-label> -->
<!-- <input
		#inputElement
		#inputElementNgModel="ngModel"
		required
		[minlength]="3"
		appIsStringAsyncValidator
		[ngModelOptions]="{
			updateOn: 'blur'
		}"
		[(ngModel)]="searchValue"
	/> -->
<!-- @Directive({exportAs: 'ngModel'}) export class ngModel ... -> #inputElementNgModel="ngModel" -->
<!-- </mat-form-field> -->
<!-- <h1>ngModel: {{inputElementNgModel.errors | json}}</h1> -->
<app-products-filter
	[brands]="brands$ | async"
	(changeFilter)="onFilterChange($event)"
></app-products-filter>

<div *ngIf="products$ | async as products; else loader" class="container">
	<ng-container
		*appPagination="
			let productsGroup of products
				| filterByParam: (searchControlValue$ | async):'name';
			elementsSize: 4;
			let allIndexes = allIndexes;
			let activeIndex = index;
			let nextItem = nextItem;
			let backItem = backItem;
			let selectIndex = selectIndex
		"
	>
		<div class="card-container">
			<app-product-card
				*ngFor="let product of productsGroup; trackBy: trackBy"
				class="product"
				[routerLink]="'/product/' + product._id"
				[product]="product"
			></app-product-card>
		</div>

		<div class="pagination-container">
			<button mat-icon-button (click)="backItem()">
				<mat-icon> chevron_left </mat-icon>
			</button>
			<button
				*ngFor="let index of allIndexes"
				mat-icon-button
				class="pagination__page-number"
				[class.pagination__page-number_active]="activeIndex === index"
				(click)="selectIndex(index)"
			>
				{{ index + 1 }}
			</button>
			<button mat-icon-button (click)="nextItem()">
				<mat-icon> chevron_right </mat-icon>
			</button>
		</div>
	</ng-container>
</div>

<ng-template #loader>
	<mat-spinner class="loader"></mat-spinner>
</ng-template>
